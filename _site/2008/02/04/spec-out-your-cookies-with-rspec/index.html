<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="keywords" content="jon maddox richmond programmer ruby cocoa va" />
  <meta name="description" content="Here lies Jon Maddox" />
  <link rel="stylesheet" href="/stylesheets/styles.css" type="text/css"> 
  <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css"> 
  <title>Spec Out Your Cookies with Rspec</title>
</head>

<body id="post">
<a href="http://github.com/maddox"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub" /></a>
<div id="content">
  <h1>Spec Out Your Cookies with Rspec</h1>
<p>Here&#8217;s something that got me this weekend and I couldn&#8217;t find much info on it anywhere. So like my Internet taught me, I&#8217;m sharing.</p>
<p><code>links_controller.rb</code></p>
<div class="highlight"><pre><span class="n">cookies</span><span class="o">[</span><span class="ss">:phone</span><span class="o">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:phone</span><span class="o">]</span>
</pre>
</div><p><code>links_controller_spec.rb</code></p>
<div class="highlight"><pre><span class="n">it</span> <span class="s2">&quot;should save the phone number in a cookie&quot;</span> <span class="k">do</span>
  <span class="vi">@my_cookies</span> <span class="o">=</span> <span class="n">mock</span><span class="p">(</span><span class="s1">&#39;cookies&#39;</span><span class="p">)</span>
  <span class="vi">@my_cookies</span><span class="o">.</span><span class="n">stub!</span><span class="p">(</span><span class="ss">:[]=</span><span class="p">)</span>
  <span class="n">controller</span><span class="o">.</span><span class="n">stub!</span><span class="p">(</span><span class="ss">:cookies</span><span class="p">)</span><span class="o">.</span><span class="n">and_return</span><span class="p">(</span><span class="vi">@my_cookies</span><span class="p">)</span>

  <span class="vi">@my_cookies</span><span class="o">.</span><span class="n">should_receive</span><span class="p">(</span><span class="ss">:[]=</span><span class="p">)</span><span class="o">.</span><span class="n">with</span><span class="p">(</span><span class="ss">:phone</span><span class="p">,</span> <span class="s1">&#39;804-755-7555&#39;</span><span class="p">)</span>

  <span class="n">do_post</span>
<span class="k">end</span>
</pre>
</div><p>Here I&#8217;m making the expectation that a cookie will be set with the key of &#8216;phone&#8217; and a value of a passed in parameter. <br />
My <code>do_post</code> method takes care of the post and passes in the parameter <code>:phone =&gt; '804-755-7555'</code>.</p>
  <div id="footer">
    <a href="/">&laquo; Return Home</a>
  </div>
</div>
</body>
</html>
