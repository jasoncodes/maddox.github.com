<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="keywords" content="jon maddox richmond programmer ruby cocoa va" />
  <meta name="description" content="Here lies Jon Maddox" />
  <link rel="stylesheet" href="/stylesheets/styles.css" type="text/css"> 
  <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css"> 
  <title>Test Your respond_to Block</title>
</head>

<body id="post">
<a href="http://github.com/maddox"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub" /></a>
<div id="content">
  <h1>Test Your respond_to Block</h1>
<p>Getting RESTful and wondering how to test your <em>respond_to</em> block in your controller to make sure its returning the right format? Drop these into your <em>test_helper.rb</em>.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">assert_xml</span>
  <span class="n">assert_match</span> <span class="s1">&#39;application/xml&#39;</span><span class="p">,</span> <span class="vi">@response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">]</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">assert_rss</span>
  <span class="n">assert_match</span> <span class="s1">&#39;application/rss+xml&#39;</span><span class="p">,</span> <span class="vi">@response</span><span class="o">.</span><span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">]</span>
<span class="k">end</span>
</pre>
</div><p>Then in your functional tests, use them like this:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">test_return_xml</span>
  <span class="n">get</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:format</span> <span class="o">=&gt;</span> <span class="s1">&#39;xml&#39;</span>
  <span class="n">assert_xml</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">test_return_rss</span>
  <span class="n">get</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:format</span> <span class="o">=&gt;</span> <span class="s1">&#39;rss&#39;</span>
  <span class="n">assert_rss</span>
<span class="k">end</span>
</pre>
</div><p>Yay!</p>
  <div id="footer">
    <a href="/">&laquo; Return Home</a>
  </div>
</div>
</body>
</html>
